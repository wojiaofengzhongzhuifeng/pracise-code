<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport"
        content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Document</title>
</head>
<body>
<script>
  /*
  * {
  *   event1: [fn1, fn2, fn3],
  *   event2: [fn4, fn5]
  * }
  * */

  class Event{
    map = {}
    add = (eventName, fn)=>{
      if(!this.map[eventName]){
        this.map[eventName] = []
      }
      this.map[eventName].push(fn)
    }
    triggle = (eventName, ...reset)=>{
      if(!this.map[eventName]){throw new Error("未注册事件" + eventName)}
      console.log(reset);
      let needTodoFnList = this.map[eventName]
      console.log(needTodoFnList);

      needTodoFnList.forEach((fn)=>{
        fn(...reset)
      })
    }
    once = (eventName, fn)=>{
      const testFn = ()=>{
        fn(...arguments)
        this.remove(eventName, testFn)
      }
      this.add(eventName, testFn)
    }
    remove = (eventName, fn)=> {
      let fnList = this.map[eventName]
      let index = fnList.indexOf(fn)
      fnList.splice(index, 1)
    }

  }

  let event = new Event()

  event.add("event1", (data)=>{
    console.log("event1", data);
  })
  event.add("event1", (data)=>{
    console.log("event11", data);
  })

  event.triggle("event1", {name: 1},  {name: 2})


</script>
</body>
</html>
